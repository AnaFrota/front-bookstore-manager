(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d226909"],{e8cc:function(e,a,t){"use strict";t.r(a);var i=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("v-card",{attrs:{rounded:"0"}},[t("v-data-table",{staticClass:"elevation-1 rounded-t",attrs:{headers:e.headers,items:e.alugueis,"items-per-page":e.pageSize,search:e.search,"hide-default-footer":"",loading:e.loading},scopedSlots:e._u([{key:"top",fn:function(){return[t("v-toolbar",{staticClass:"indigo lighten-3 rounded-t",attrs:{flat:""}},[t("v-toolbar-title",{staticClass:"white--text"},[e._v("Alugueis")]),t("v-divider",{staticClass:"mx-4 white",attrs:{inset:"",vertical:""}}),t("v-text-field",{staticClass:"white--text",attrs:{"append-icon":"mdi-magnify",label:"Procurar...","single-line":"","hide-details":"",color:"white",dark:""},model:{value:e.search,callback:function(a){e.search=a},expression:"search"}}),t("v-spacer"),t("v-dialog",{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function(a){var i=a.on,l=a.attrs;return[t("v-btn",e._g(e._b({staticClass:"mb-2",attrs:{color:"indigo accent-1",dark:""}},"v-btn",l,!1),i),[e._v(" Novo Aluguel ")])]}}]),model:{value:e.dialog,callback:function(a){e.dialog=a},expression:"dialog"}},[t("v-card",{attrs:{width:"500",height:"700"}},[t("v-card-title",{staticClass:"indigo lighten-3"},[t("span",{staticClass:"text-h5 white--text"},[e._v(e._s(e.formTitle))])]),t("v-card-text",[t("v-form",{ref:"form"},[t("v-container",[t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-select",{attrs:{items:e.livros,"item-text":"nome","item-value":"id",label:"Escolha um livro",color:"indigo lighten-3","item-color":"indigo lighten-3","no-data-text":"Sem livros no estoque",rules:[e.rules.required],outlined:""},scopedSlots:e._u([{key:"selection",fn:function(a){return[e._v(" "+e._s(a.item.id)+" - "+e._s(a.item.nome)+" ")]}},{key:"item",fn:function(a){return[e._v(" "+e._s(a.item.id)+" - "+e._s(a.item.nome)+" ")]}}]),model:{value:e.aluguel.livroId,callback:function(a){e.$set(e.aluguel,"livroId",a)},expression:"aluguel.livroId"}})],1)],1),t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-select",{attrs:{items:e.usuarios,"item-text":"nome","item-value":"id",label:"Escolha um usuario",color:"indigo lighten-3","item-color":"indigo lighten-3",rules:[e.rules.required],outlined:""},scopedSlots:e._u([{key:"selection",fn:function(a){return[e._v(" "+e._s(a.item.id)+" - "+e._s(a.item.nome)+" ")]}},{key:"item",fn:function(a){return[e._v(" "+e._s(a.item.id)+" - "+e._s(a.item.nome)+" ")]}}]),model:{value:e.aluguel.usuarioId,callback:function(a){e.$set(e.aluguel,"usuarioId",a)},expression:"aluguel.usuarioId"}})],1)],1),t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(a){var i=a.on,l=a.attrs;return[t("v-text-field",e._g(e._b({attrs:{label:"Data de aluguel","append-icon":"mdi-calendar",readonly:"",outlined:"",rules:[e.rules.required],hint:"Selecione a data de aluguel",color:"indigo lighten-3"},on:{blur:function(a){e.dateAluguel=e.parseDate(e.dateFormatted)}},model:{value:e.aluguel.dataAluguel,callback:function(a){e.$set(e.aluguel,"dataAluguel",a)},expression:"aluguel.dataAluguel"}},"v-text-field",l,!1),i))]}}]),model:{value:e.menuAluguel,callback:function(a){e.menuAluguel=a},expression:"menuAluguel"}},[t("v-date-picker",{attrs:{"no-title":"",scrollable:"",color:"indigo lighten-3"},on:{input:function(a){e.menuAluguel=!1}},model:{value:e.dateAluguel,callback:function(a){e.dateAluguel=a},expression:"dateAluguel"}})],1)],1)],1),t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(a){var i=a.on,l=a.attrs;return[t("v-text-field",e._g(e._b({attrs:{label:"Data de previsão","append-icon":"mdi-calendar",readonly:"",outlined:"",rules:[e.rules.required],hint:"Selecione a data de previsão",color:"indigo lighten-3"},on:{blur:function(a){e.datePrevisao=e.parseDate(e.dateFormatted)}},model:{value:e.aluguel.dataPrevisao,callback:function(a){e.$set(e.aluguel,"dataPrevisao",a)},expression:"aluguel.dataPrevisao"}},"v-text-field",l,!1),i))]}}]),model:{value:e.menuPrevisao,callback:function(a){e.menuPrevisao=a},expression:"menuPrevisao"}},[t("v-date-picker",{attrs:{"no-title":"",scrollable:"",min:e.dateAluguel,color:"indigo lighten-3"},on:{input:function(a){e.menuPrevisao=!1}},model:{value:e.datePrevisao,callback:function(a){e.datePrevisao=a},expression:"datePrevisao"}})],1)],1)],1),t("v-row",[t("v-col",{attrs:{cols:"12"}},[t("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function(a){var i=a.on,l=a.attrs;return[t("v-text-field",e._g(e._b({attrs:{label:"Data de devolução","append-icon":"mdi-calendar",readonly:"",outlined:"",hint:"Selecione a data de devolução",color:"indigo lighten-3"},on:{blur:function(a){e.dateDevolucao=e.parseDate(e.dateFormatted)}},model:{value:e.aluguel.dataDevolucao,callback:function(a){e.$set(e.aluguel,"dataDevolucao",a)},expression:"aluguel.dataDevolucao"}},"v-text-field",l,!1),i))]}}]),model:{value:e.menuDevolucao,callback:function(a){e.menuDevolucao=a},expression:"menuDevolucao"}},[t("v-date-picker",{attrs:{"no-title":"",min:e.dateAluguel,scrollable:"",color:"indigo lighten-3"},on:{input:function(a){e.menuDevolucao=!1}},model:{value:e.dateDevolucao,callback:function(a){e.dateDevolucao=a},expression:"dateDevolucao"}})],1)],1)],1)],1)],1)],1),t("v-card-actions",[t("v-spacer"),t("v-btn",{attrs:{color:"red accent-4",text:""},on:{click:e.close}},[e._v(" Cancelar ")]),t("v-btn",{attrs:{color:"teal accent-4",text:""},on:{click:e.save}},[e._v(" Salvar ")])],1)],1)],1)],1)]},proxy:!0},{key:"item.status",fn:function(a){var i=a.item;return[t("v-chip",{attrs:{color:e.getColor(i.status),dark:""}},[e._v(" "+e._s(i.status)+" ")])]}},{key:"item.actions",fn:function(a){var i=a.item;return[t("v-icon",{staticClass:"mr-2",attrs:{size:"20"},on:{click:function(a){return e.editItem(i)}}},[e._v(" mdi-pencil ")]),t("v-icon",{directives:[{name:"show",rawName:"v-show",value:!i.dataDevolucao,expression:"!item.dataDevolucao"}],staticClass:"mr-2",attrs:{size:"20"},on:{click:function(a){return e.returnBook(i)}}},[e._v(" mdi-book-check-outline ")])]}},{key:"no-data",fn:function(){return[t("v-btn",{attrs:{color:"primary"},on:{click:e.initialize}},[e._v(" Reset ")])]},proxy:!0}],null,!0)})],1),t("v-divider"),t("v-card",{attrs:{rounded:"0",color:"indigo lighten-3 rounded-b"}},[t("v-col",{attrs:{cols:"12"}},[t("v-row",[t("v-col",{attrs:{cols:"4",sm:"4"}},[t("v-select",{attrs:{items:e.pageSizes,label:"Itens por Pagina",outlined:"","item-color":"black",color:"black",dark:""},on:{change:e.handlePageSizeChange},model:{value:e.pageSize,callback:function(a){e.pageSize=a},expression:"pageSize"}})],1),t("v-col",{attrs:{cols:"12",sm:"8"}},[t("v-pagination",{attrs:{length:e.totalPages,"total-visible":"7","next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left",color:"indigo accent-1"},on:{input:e.handlePageChange},model:{value:e.page,callback:function(a){e.page=a},expression:"page"}})],1)],1)],1)],1)],1)},l=[],o=t("3835"),u=(t("d81d"),t("fb6a"),t("ac1f"),t("1276"),t("99af"),t("4d90"),t("3d20")),n=t.n(u),s=t("65c5"),r=t("086f"),c=t("9249"),d=t("c1df"),v=t.n(d),g={name:"App",data:function(){return{dialog:!1,dialogDelete:!1,loading:!0,menuAluguel:!1,menuPrevisao:!1,menuDevolucao:!1,search:"",alugueis:[],livros:[],usuarios:[],dateAluguel:"",datePrevisao:"",dateDevolucao:"",dateFormatted:"",totalAlugueis:0,page:1,totalPages:0,pageSize:5,pageSizes:[5,10,15],aluguel:{id:null,usuarioId:null,usuario:{},livroId:null,livro:{},dataAluguel:"",dataPrevisao:"",dataDevolucao:""},headers:[{text:"ID",align:"start",sortable:!0,value:"id"},{text:"Livro",value:"livro.nome"},{text:"Usuário",value:"usuario.nome"},{text:"Aluguel",value:"dataAluguel"},{text:"Previsão",value:"dataPrevisao"},{text:"Devolução",value:"dataDevolucao"},{text:"Status",value:"status"},{text:"Ações",value:"actions",sortable:!1}],rules:{required:function(e){return!!e||"Campo obrigatório"},quantityLivro:function(e){return 0!=e.quantidade||"Livro faltando"}}}},computed:{formTitle:function(){return this.aluguel.id?"Editar Aluguel":"Novo Aluguel"}},watch:{dialog:function(e){e||this.close()},dialogDelete:function(e){e||this.closeDelete()},dateAluguel:function(){this.aluguel.dataAluguel=this.formatDate(this.dateAluguel)},datePrevisao:function(){this.aluguel.dataPrevisao=this.formatDate(this.datePrevisao)},dateDevolucao:function(){this.aluguel.dataDevolucao=this.formatDate(this.dateDevolucao)}},created:function(){this.initialize()},methods:{initialize:function(){var e=this,a=this.getRequestParams(this.page,this.pageSize);this.loading=!0,s["a"].findAll(a).then((function(a){var t=a.data,i=t.totalElements,l=t.totalPages,o=t.content;e.alugueis=o.map((function(a){return Object.defineProperty(a,"status",{value:e.getStatus(a)}),a})),e.totalAlugueis=i,e.totalPages=l,e.loading=!1})),this.findAllUsuarios(),this.findAllLivros()},getRequestParams:function(e,a){var t={};return e&&(t["page"]=e-1),a&&(t["size"]=a),t},handlePageChange:function(e){this.page=e,this.initialize()},handlePageSizeChange:function(e){this.pageSize=e,this.page=1,this.initialize()},editItem:function(e){this.aluguel.id=e.id,this.aluguel.usuarioId=e.usuario.id,this.aluguel.usuario=e.usuario,this.aluguel.livroId=e.livro.id,this.aluguel.livro=e.livro,this.aluguel.dataAluguel=e.dataAluguel,this.aluguel.dataPrevisao=e.dataPrevisao,this.aluguel.dataDevolucao=e.dataDevolucao,this.dialog=!0},returnBook:function(e){var a=this;this.aluguel.id=e.id,this.aluguel.usuarioId=e.usuario.id,this.aluguel.usuario=e.usuario,this.aluguel.livroId=e.livro.id,this.aluguel.livro=e.livro,this.aluguel.dataAluguel=e.dataAluguel,this.aluguel.dataPrevisao=e.dataPrevisao,this.aluguel.dataDevolucao=v()((new Date).toISOString().slice(0,10)).format("DD-MM-YYYY"),s["a"].update(this.aluguel).then((function(){a.aluguel={},a.initialize(),n.a.fire("Livro devolvido com sucesso","","success")}))},close:function(){this.dialog=!1,this.$refs.form.resetValidation(),this.dialog||(this.dateAluguel="",this.aluguel={})},closeDelete:function(){this.dialogDelete=!1},save:function(){var e=this;this.$refs.form.validate()&&(v()(this.aluguel.dataPrevisao,"DD-MM-YYYY").isBefore(v()(this.aluguel.dataAluguel,"DD-MM-YYYY"))||v()(this.aluguel.dataDevolucao,"DD-MM-YYYY").isBefore(v()(this.aluguel.dataAluguel,"DD-MM-YYYY"))?(this.close(),n.a.fire("Data de aluguel não pode ser maior que às demais","","error")):this.aluguel.id?s["a"].update(this.aluguel).then((function(){n.a.fire("Aluguel alterado com sucesso","","success"),e.aluguel={},e.initialize()})).catch((function(){e.close(),n.a.fire("Livro selecionado, com 0 quantidade no estoque","","error")})):s["a"].save(this.aluguel).then((function(){n.a.fire("Aluguel cadastrado com sucesso","","success"),e.aluguel={},e.initialize()})).catch((function(){e.close(),n.a.fire("Livro selecionado, com 0 quantidade no estoque","","error")})),this.aluguel={},this.close())},findAllLivros:function(){var e=this;c["a"].findAllNotPaged().then((function(a){e.livros=a.data}))},findAllUsuarios:function(){var e=this;r["a"].findAllNotPaged().then((function(a){e.usuarios=a.data}))},formatDate:function(e){if(!e)return null;var a=e.split("-"),t=Object(o["a"])(a,3),i=t[0],l=t[1],u=t[2];return"".concat(u,"-").concat(l,"-").concat(i)},getStatus:function(e){return v()(e.dataPrevisao,"DD-MM-YYYY").isBefore(v()(e.dataDevolucao,"DD-MM-YYYY"))?"Atrasado":v()(e.dataPrevisao,"DD-MM-YYYY").isSameOrAfter(v()(e.dataDevolucao,"DD-MM-YYYY"))?"No prazo":e.dataPrevisao?"Pendente":void 0},getColor:function(e){return"No prazo"==e?"green":"Pendente"==e?"orange":"red"},parseDate:function(e){if(!e)return null;var a=e.split("/"),t=Object(o["a"])(a,3),i=t[0],l=t[1],u=t[2];return"".concat(u,"-").concat(i.padStart(2,"0"),"-").concat(l.padStart(2,"0"))}}},f=g,h=t("2877"),m=t("6544"),p=t.n(m),D=t("8336"),b=t("b0af"),k=t("99d9"),x=t("cc20"),A=t("62ad"),P=t("a523"),_=t("8fea"),Y=t("2e4b"),S=t("169a"),w=t("ce7e"),C=t("4bd4"),y=t("132d"),z=t("e449"),V=t("891e"),M=t("0fd9"),I=t("b974"),q=t("2fa4"),T=t("8654"),L=t("71d9"),$=t("2a7f"),N=Object(h["a"])(f,i,l,!1,null,null,null);a["default"]=N.exports;p()(N,{VBtn:D["a"],VCard:b["a"],VCardActions:k["a"],VCardText:k["b"],VCardTitle:k["c"],VChip:x["a"],VCol:A["a"],VContainer:P["a"],VDataTable:_["a"],VDatePicker:Y["a"],VDialog:S["a"],VDivider:w["a"],VForm:C["a"],VIcon:y["a"],VMenu:z["a"],VPagination:V["a"],VRow:M["a"],VSelect:I["a"],VSpacer:q["a"],VTextField:T["a"],VToolbar:L["a"],VToolbarTitle:$["b"]})}}]);
//# sourceMappingURL=chunk-2d226909.3fca89a1.js.map